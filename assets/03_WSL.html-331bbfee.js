import{_ as e,X as a,Y as i,a2 as n}from"./framework-26c8dc72.js";const s={},d=n(`<h1 id="construcao-dos-ambientes-de-desenvolvimento-com-wsl" tabindex="-1"><a class="header-anchor" href="#construcao-dos-ambientes-de-desenvolvimento-com-wsl" aria-hidden="true">#</a> Construção dos ambientes de desenvolvimento com WSL</h1><h2 id="wsl-update" tabindex="-1"><a class="header-anchor" href="#wsl-update" aria-hidden="true">#</a> WSL update</h2><p>Garanta que seu WSL está atualizado</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl.exe --update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="instalando-o-wsl-debian" tabindex="-1"><a class="header-anchor" href="#instalando-o-wsl-debian" aria-hidden="true">#</a> Instalando o WSL Debian</h2><ul><li>no prompt rodar o seguinte comando</li></ul><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --install --distribution Debian
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>definir UNIX username como <strong>dev</strong></li><li>definir New password como <strong>dev</strong></li><li>finalizar a instalação.</li></ul><h2 id="criando-ambientes-especificos" tabindex="-1"><a class="header-anchor" href="#criando-ambientes-especificos" aria-hidden="true">#</a> Criando ambientes específicos</h2><ul><li>Criar o diretório no D:\\WSLWorkspaces</li></ul><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>mkdir D:\\WSLWorkspaces
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>acessar D:\\WSLWorkspaces</li></ul><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>cd D:\\WSLWorkspaces
d:
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Exportar a versão original do Debian para servir como base</li></ul><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --export Debian DebianTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Importar template para novo WSL</li></ul><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --import DebianNode DebianNodeFolder DebianTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --import DebianJava DebianJavaFolder DebianTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --import DebianC DebianCFolder DebianTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --import DebianMySQL DebianMySQLFolder DebianTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="executando-ambientes" tabindex="-1"><a class="header-anchor" href="#executando-ambientes" aria-hidden="true">#</a> Executando ambientes</h2><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl -d DebianJava
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="removendo-wsl" tabindex="-1"><a class="header-anchor" href="#removendo-wsl" aria-hidden="true">#</a> Removendo WSL</h2><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --unregister DebianJava 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="wsl2-forward-port" tabindex="-1"><a class="header-anchor" href="#wsl2-forward-port" aria-hidden="true">#</a> WSL2 Forward Port</h2><h2 id="wsl-conf-e-wslconfig" tabindex="-1"><a class="header-anchor" href="#wsl-conf-e-wslconfig" aria-hidden="true">#</a> <code>wsl.conf</code> e <code>.wslconfig</code></h2><p>Você pode definir as configurações para suas distribuições do Linux instaladas que serão aplicadas automaticamente sempre que você iniciar o WSL de duas maneiras, usando:</p><ul><li><code>.wslconfig</code> para definir as configurações globalmente em todas as distribuições instaladas em execução no WSL 2.</li><li><code>wsl.conf</code> para definir as configurações por distribuição para distribuições do Linux em execução no WSL 1 ou WSL 2.</li></ul><h2 id="wslconfig" tabindex="-1"><a class="header-anchor" href="#wslconfig" aria-hidden="true">#</a> <code>.wslconfig</code></h2><p><strong>Só pode ser usado para distribuições executadas pelo WSL 2</strong></p><p>Para acessar seu <code>%UserProfile%</code> diretório, no PowerShell, use</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>cd ~
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>para acessar seu diretório base (que normalmente é seu perfil de usuário, C:\\Users&lt;UserName&gt;)</p><p>Outra opção é você pode abrir o Windows Explorador de Arquivos e inserir <code>%UserProfile%</code> na barra de endereços.</p><p>O caminho do diretório deve ser semelhante a:</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>C:\\Users\\&lt;UserName&gt;\\.wslconfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="exemplo-de-arquivo-wslconfig" tabindex="-1"><a class="header-anchor" href="#exemplo-de-arquivo-wslconfig" aria-hidden="true">#</a> Exemplo de arquivo .wslconfig</h2><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code># Settings apply across all Linux distros running on WSL 2
[wsl2]

# Limits VM memory to use no more than 4 GB, this can be set as whole numbers using GB or MB
memory=4GB 

# Sets the VM to use two virtual processors
processors=2

# Specify a custom Linux kernel to use with your installed distros. The default kernel used can be found at https://github.com/microsoft/WSL2-Linux-Kernel
kernel=C:\\\\temp\\\\myCustomKernel

# Sets additional kernel parameters, in this case enabling older Linux base images such as Centos 6
kernelCommandLine = vsyscall=emulate

# Sets amount of swap storage space to 8GB, default is 25% of available RAM
swap=8GB

# Sets swapfile path location, default is %USERPROFILE%\\AppData\\Local\\Temp\\swap.vhdx
swapfile=C:\\\\temp\\\\wsl-swap.vhdx

# Disable page reporting so WSL retains all allocated memory claimed from Windows and releases none back when free
pageReporting=false

# Turn off default connection to bind WSL 2 localhost to Windows localhost
localhostforwarding=true

# Disables nested virtualization
nestedVirtualization=false

# Turns on output console showing contents of dmesg when opening a WSL 2 distro for debugging
debugConsole=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="a-regra-de-8-segundos" tabindex="-1"><a class="header-anchor" href="#a-regra-de-8-segundos" aria-hidden="true">#</a> A regra de 8 segundos</h2><p>Você deve aguardar até que o subsistema que executa a distribuição do Linux pare completamente de ser executado e reinicie para que as atualizações de configuração sejam exibidas. Normalmente, isso leva cerca de 8 segundos depois de fechar TODAS as instâncias do shell de distribuição.</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --list --running
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --shutdown
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="debian-docker" tabindex="-1"><a class="header-anchor" href="#debian-docker" aria-hidden="true">#</a> Debian Docker</h2><h3 id="configure-o-repositorio" tabindex="-1"><a class="header-anchor" href="#configure-o-repositorio" aria-hidden="true">#</a> Configure o repositório</h3><ol><li><p>Atualize o índice de pacote APT e instale os pacotes para permitir que o Apt use um repositório sobre o HTTPS:</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo apt-get update
sudo apt-get install \\
    ca-certificates \\
    curl \\
    gnupg \\
    lsb-release
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Adicione a chave GPG oficial do Docker:</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo mkdir -m 0755 -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Use o seguinte comando para configurar o repositório:</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>echo \\
    &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \\
    $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="instale-o-docker" tabindex="-1"><a class="header-anchor" href="#instale-o-docker" aria-hidden="true">#</a> Instale o Docker</h3><ol><li>Atualize o índice de pacote APT:<div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo apt-get update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li>Instele o Docker Engine, containerd, e Docker Compose plugin.<div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h3 id="erro-iptables" tabindex="-1"><a class="header-anchor" href="#erro-iptables" aria-hidden="true">#</a> erro iptables</h3><p>O instalador do Docker usa iptables para NAT. Infelizmente, o Debian usa o Nftables. Você pode converter as entradas em nftables ou apenas configurar o Debian para usar os iptables legados.</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo update-alternatives --set iptables /usr/sbin/iptables-legacy
sudo update-alternatives --set ip6tables /usr/sbin/ip6tables-legacy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Dockerd, deve começar bem depois de mudar para a iptables legado.</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo service docker start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="rodando-uma-imagem" tabindex="-1"><a class="header-anchor" href="#rodando-uma-imagem" aria-hidden="true">#</a> Rodando uma imagem</h3><ol><li>Verifique se a instalação do docker está bem-sucedida executando a imagem do Hello-World:<div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo docker run hello-world
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h3 id="fazendo-o-docker-inicializar-no-boot" tabindex="-1"><a class="header-anchor" href="#fazendo-o-docker-inicializar-no-boot" aria-hidden="true">#</a> Fazendo o docker inicializar no boot</h3><p>Criar o arquivo <code>/etc/wsl.conf</code> com o seguinte conteúdo:</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code># Set a command to run when a new WSL instance launches. This example starts the Docker container service.
[boot]
command = service docker start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="exportando-debian-com-docker" tabindex="-1"><a class="header-anchor" href="#exportando-debian-com-docker" aria-hidden="true">#</a> Exportando Debian com Docker</h3><p>Exportar a versão original do Debian com Docker para servir como base</p><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>sudo apt-get autoclean
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --export Debian DebianDockerTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --export Debian DebianDockerTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Importar template para novo WSL</li></ul><div class="language-console line-numbers-mode" data-ext="console"><pre class="language-console"><code>wsl --import DebianOwnCloud DebianOwnCloud DebianDockerTemplate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="referencia" tabindex="-1"><a class="header-anchor" href="#referencia" aria-hidden="true">#</a> Referência</h2><ul><li>https://docs.docker.com/engine/install/debian/</li><li>https://forums.docker.com/t/failing-to-start-dockerd-failed-to-create-nat-chain-docker/78269</li><li>https://learn.microsoft.com/pt-br/windows/wsl/wsl-config</li></ul>`,66),o=[d];function l(r,c){return a(),i("div",null,o)}const u=e(s,[["render",l],["__file","03_WSL.html.vue"]]);export{u as default};
